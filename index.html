<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Matem√°ticas 4¬∫ ESO - Versi√≥n B</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
        }
        .math-display { font-size: 1.1em; margin: 1em 0; }
        @media print {
            .no-print { display: none !important; }
            .print-break { page-break-after: always; }
        }
    </style>
</head>
<body>
    <div id="app"></div>
    
    <script>
        const ejercicios = {
            "numeros": {
                title: "N√öMEROS Y √ÅLGEBRA",
                color: "from-blue-500 to-blue-600",
                preguntas: [
                    {
                        num: 1,
                        enunciado: "Opera:",
                        formula: "\\frac{2}{3} + \\frac{1}{4} \\cdot \\frac{3}{5} - 0,6 - \\left[\\left(\\frac{1}{3}\\right)^2 + \\left(\\frac{1}{3}\\right)^{-2}\\right]",
                        solucion: "-9"
                    },
                    {
                        num: 2,
                        enunciado: "Escribe en forma de desigualdad y representa:",
                        partes: [
                            "a) \\((-\\infty, 4]\\)",
                            "b) \\([2, 6)\\)",
                            "c) Si existe, halla el intervalo com√∫n"
                        ],
                        solucion: "a) x ‚â§ 4<br>b) 2 ‚â§ x < 6<br>c) Intervalo com√∫n: [2, 4]"
                    },
                    {
                        num: 3,
                        enunciado: "Realiza las siguientes operaciones expresando el resultado como potencia de exponente entero:",
                        formula: "\\frac{\\left(\\frac{2}{3}\\right)^{-2} \\cdot 9^{-3} \\cdot \\frac{1}{8}}{\\left(-3\\right)^{-4} \\cdot \\left(\\frac{3}{2}\\right)^{-3} \\cdot \\left(-\\frac{2}{3}\\right)^{-1}}",
                        solucion: "3^{-2} = \\frac{1}{9}"
                    },
                    {
                        num: 4,
                        enunciado: "Opera y simplifica:",
                        partes: [
                            "a) \\(\\sqrt{12x} + 3\\sqrt[3]{x^3} - 2\\sqrt{3x} + 4\\sqrt{x}\\)",
                            "b) \\(4\\sqrt{2} - \\sqrt{\\frac{32}{9}} - \\sqrt{75} + \\sqrt{\\frac{2}{25}}\\)",
                            "c) \\(\\sqrt[3]{3xy} \\cdot \\sqrt[6]{x^2y^3} : \\sqrt[3]{xy^2}\\)",
                            "d) \\(\\sqrt[3]{\\frac{2}{3}} \\cdot \\sqrt{\\frac{3}{2}}\\)"
                        ],
                        solucion: "a) \\sqrt{3x} + 3x<br>b) -\\frac{\\sqrt{3}}{3}<br>c) \\sqrt[6]{xy}<br>d) \\sqrt[6]{3}"
                    },
                    {
                        num: 5,
                        enunciado: "Calcular el valor de:",
                        formula: "\\frac{\\sqrt{100 \\cdot \\sqrt{25}}}{\\sqrt[3]{125 \\cdot \\sqrt{16}}}",
                        solucion: "2"
                    },
                    {
                        num: 6,
                        enunciado: "Expresa el resultado en forma de potencia √∫nica y tambi√©n como √∫nico radical:",
                        partes: [
                            "a) \\(\\dfrac{\\sqrt[4]{x^5}}{x^{-3}}\\)",
                            "b) \\(\\dfrac{\\sqrt[5]{32} \\cdot 2^{-2}}{\\sqrt{4}}\\)"
                        ],
                        solucion: "a) x^{17/4} = \\sqrt[4]{x^{17}}<br>b) 2^{-1} = \\frac{1}{2}"
                    },
                    {
                        num: 7,
                        enunciado: "Racionaliza las siguientes expresiones:",
                        partes: [
                            "a) \\(\\dfrac{10}{\\sqrt{5}}\\)",
                            "b) \\(\\dfrac{12}{\\sqrt[3]{4}}\\)",
                            "c) \\(\\dfrac{\\sqrt{10} + \\sqrt{2}}{\\sqrt{10} - \\sqrt{2}}\\)",
                            "d) \\(\\dfrac{3\\sqrt{5} + 2\\sqrt{3}}{3\\sqrt{5} - 2\\sqrt{3}}\\)"
                        ],
                        solucion: "a) 2\\sqrt{5}<br>b) 3\\sqrt[3]{2}<br>c) 3 + \\sqrt{5}<br>d) \\frac{27 + 12\\sqrt{15}}{33}"
                    },
                    {
                        num: 8,
                        enunciado: "Efect√∫a las siguientes operaciones:",
                        partes: [
                            "a) \\((4 - \\sqrt{3}) \\cdot (4 + \\sqrt{3})\\)",
                            "b) \\(\\left(\\sqrt{7} - 2\\sqrt{2}\\right)^2\\)"
                        ],
                        solucion: "a) 13<br>b) 15 - 4\\sqrt{14}"
                    },
                    {
                        num: 9,
                        enunciado: "Realiza las siguientes operaciones y expresa el resultado en notaci√≥n cient√≠fica:",
                        partes: [
                            "a) \\(\\dfrac{(4 \\cdot 10^{10}) \\cdot (3 \\cdot 10^7)}{10^{-3}}\\)",
                            "b) \\(5 \\cdot 10^7 - 2,5 \\cdot 10^6 + 3 \\cdot 10^7\\)"
                        ],
                        solucion: "a) 1,2 √ó 10^{21}<br>b) 7,75 √ó 10^7"
                    }
                ]
            },
            "polinomios": {
                title: "POLINOMIOS",
                color: "from-green-500 to-green-600",
                preguntas: [
                    {
                        num: 10,
                        enunciado: "Efect√∫a la divisi√≥n del polinomio \\(P(x) = 2x^4 + 3x^3 + 5x - 10\\) entre el polinomio \\(Q(x) = x^2 - 3\\).",
                        detalle: "Indica cu√°l es el cociente C(x) y el resto R(x) de esta divisi√≥n.",
                        solucion: "C(x) = 2x^2 + 3x + 6<br>R(x) = 23x + 8"
                    },
                    {
                        num: 11,
                        enunciado: "Efect√∫a la siguiente divisi√≥n usando la regla de Ruffini.",
                        detalle: "Indica cu√°l es el cociente C(x) y el resto R de la divisi√≥n.",
                        formula: "-2x^5 + 4x^3 - 3x^2 + 6x - 4 \\text{ dividido por } x - 2",
                        solucion: "C(x) = -2x^4 - 4x^3 - 4x^2 - 11x - 16<br>R = -36"
                    },
                    {
                        num: 12,
                        enunciado: "Factoriza los siguientes polinomios:",
                        partes: [
                            "a) \\(x^4 - 6x^3 + 8x^2 + 6x - 9\\)",
                            "b) \\(x^4 + 4x^3 - 9x^2 - 36x\\)"
                        ],
                        solucion: "a) (x-1)(x-3)^2(x+1)<br>b) x(x+4)(x-3)(x+3)"
                    },
                    {
                        num: 13,
                        enunciado: "El resto de la divisi√≥n del polinomio \\(P(x) = 3x^4 - kx^2 + 4x - 5\\) entre \\(x - 2\\) es igual a 15.",
                        detalle: "Halla el valor de k.",
                        solucion: "k = -3"
                    }
                ]
            },
            "logaritmos": {
                title: "LOGARITMOS",
                color: "from-purple-500 to-purple-600",
                preguntas: [
                    {
                        num: 14,
                        enunciado: "Sabiendo que \\(\\log_2 A = 3,2\\) y que \\(\\log_2 B = -1,6\\), calcular:",
                        partes: [
                            "a) \\(\\log_2\\left(\\dfrac{A \\cdot B}{4}\\right)\\)",
                            "b) \\(\\log_2\\left(\\dfrac{2\\sqrt{A}}{B^3}\\right)\\)"
                        ],
                        solucion: "a) -0,4<br>b) 7,4"
                    },
                    {
                        num: 15,
                        enunciado: "Calcular el valor de x en esta igualdad:",
                        formula: "\\ln x + \\ln 4 - 2\\ln 8 = \\ln 3",
                        solucion: "x = 48"
                    },
                    {
                        num: 16,
                        enunciado: "Desarrolla las siguientes expresiones:",
                        partes: [
                            "a) \\(\\log\\left(\\dfrac{x^4 \\cdot \\sqrt[3]{y^5}}{1000 \\cdot z^3}\\right)\\)",
                            "b) \\(\\ln\\left(\\dfrac{\\sqrt[4]{a^3 \\cdot b^6}}{\\sqrt[3]{c^4}}\\right)\\)"
                        ],
                        solucion: "a) 4\\log x + \\frac{5}{3}\\log y - 3 - 3\\log z<br>b) \\frac{3}{4}\\ln a + \\frac{3}{2}\\ln b - \\frac{4}{3}\\ln c"
                    },
                    {
                        num: 17,
                        enunciado: "Calcular el valor de x en esta igualdad:",
                        partes: [
                            "a) \\(\\ln x = \\ln 20 + \\ln 6\\)",
                            "b) \\(\\log x = \\log 72 - \\log 18\\)"
                        ],
                        solucion: "a) x = 120<br>b) x = 4"
                    },
                    {
                        num: 18,
                        enunciado: "Hallar el valor de x en estas expresiones:",
                        partes: [
                            "a) \\(\\ln x = 3\\ln 4 - 2\\ln 2\\)",
                            "b) \\(\\log x = 5\\log 2 - \\frac{1}{2}\\log 4\\)"
                        ],
                        solucion: "a) x = 16<br>b) x = 16"
                    },
                    {
                        num: 19,
                        enunciado: "Calcula x en las siguientes igualdades:",
                        partes: [
                            "a) \\(\\log 4^x = 2\\)",
                            "b) \\(\\log x^2 = -2\\)"
                        ],
                        solucion: "a) x ‚âà 3,32<br>b) x = 0,1"
                    },
                    {
                        num: 20,
                        enunciado: "Sabiendo que \\(\\log x = 0,40\\), calcula:",
                        partes: [
                            "a) \\(\\log\\left(\\dfrac{\\sqrt{x^5}}{100}\\right)\\)",
                            "b) \\(\\log(10000 \\cdot x^3)\\)",
                            "c) \\(\\log\\left(\\dfrac{1}{\\sqrt[3]{x^2}}\\right)\\)",
                            "d) \\(\\log(1000 \\cdot x) + \\log\\left(\\frac{1}{x^3}\\right)\\)"
                        ],
                        solucion: "a) -1<br>b) 5,2<br>c) ‚âà -0,267<br>d) 1,8"
                    },
                    {
                        num: 21,
                        enunciado: "Expresa como un solo logaritmo y calcula el valor de A:",
                        formula: "\\log 16 + 2\\log 3 - \\log 4 = \\log A",
                        solucion: "A = 36"
                    },
                    {
                        num: 22,
                        enunciado: "¬øCu√°l de estas expresiones son verdaderas?",
                        partes: [
                            "a) \\(\\log p + \\log q = \\log(p + q)\\)",
                            "b) \\(\\log p - \\log q = \\dfrac{\\log p}{\\log q}\\)",
                            "c) \\(\\log p - \\log q = \\log\\left(\\frac{p}{q}\\right)\\)",
                            "d) \\(\\log x^4 = 4\\log x + \\log x\\)",
                            "e) \\(\\log(m^2 - n^2) = \\log(m + n) + \\log(m - n)\\)"
                        ],
                        solucion: "a) FALSA<br>b) FALSA<br>c) VERDADERA<br>d) FALSA<br>e) VERDADERA"
                    }
                ]
            }
        };

        let state = {
            seccionActual: null,
            mostrarSoluciones: false,
            nombreAlumno: localStorage.getItem('nombreAlumno4ESO') || '',
            respuestas: JSON.parse(localStorage.getItem('respuestas4ESO') || '{}')
        };

        function guardarEstado() {
            localStorage.setItem('nombreAlumno4ESO', state.nombreAlumno);
            localStorage.setItem('respuestas4ESO', JSON.stringify(state.respuestas));
        }

        function setNombre() {
            const input = document.getElementById('nombreInput');
            if (input && input.value.trim()) {
                state.nombreAlumno = input.value.trim();
                guardarEstado();
                render();
            }
        }

        function toggleSoluciones() {
            state.mostrarSoluciones = !state.mostrarSoluciones;
            render();
        }

        function verSeccion(seccion) {
            state.seccionActual = seccion;
            render();
        }

        function volverInicio() {
            state.seccionActual = null;
            render();
        }

        function imprimirExamen() {
            window.print();
        }

        function reiniciarProgreso() {
            if (confirm('¬øSeguro que quieres borrar todo tu progreso y empezar de nuevo?')) {
                localStorage.clear();
                state = {
                    seccionActual: null,
                    mostrarSoluciones: false,
                    nombreAlumno: '',
                    respuestas: {}
                };
                render();
            }
        }

        function render() {
            const app = document.getElementById('app');
            
            if (!state.nombreAlumno) {
                app.innerHTML = renderModalNombre();
                return;
            }

            app.innerHTML = `
                <div class="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 p-4">
                    <div class="max-w-7xl mx-auto">
                        ${renderHeader()}
                        ${state.seccionActual ? renderSeccion() : renderMenuPrincipal()}
                    </div>
                </div>
            `;

            // Procesar MathJax despu√©s de renderizar
            if (window.MathJax) {
                MathJax.typesetPromise().catch((err) => console.log(err));
            }
        }

        function renderModalNombre() {
            return `
                <div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                    <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                        <div class="text-6xl text-center mb-4">üìö</div>
                        <h2 class="text-3xl font-bold text-gray-800 mb-2 text-center">¬°Bienvenido!</h2>
                        <p class="text-gray-600 mb-6 text-center">Examen de Matem√°ticas - 4¬∫ ESO</p>
                        <p class="text-gray-700 mb-4">Por favor, introduce tu nombre completo:</p>
                        <input type="text" id="nombreInput" placeholder="Tu nombre y apellidos" 
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none mb-4"
                            onkeypress="if(event.key==='Enter') setNombre()">
                        <button onclick="setNombre()" 
                            class="w-full px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-lg hover:from-indigo-700 hover:to-purple-700 transition font-medium">
                            Comenzar Examen
                        </button>
                    </div>
                </div>
            `;
        }

        function renderHeader() {
            return `
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl shadow-2xl p-8 mb-8 text-white no-print">
                    <div class="flex items-center justify-between mb-4 flex-wrap gap-4">
                        <div class="flex items-center gap-4">
                            <div class="text-5xl">üìê</div>
                            <div>
                                <h1 class="text-4xl font-bold mb-2">Examen Matem√°ticas 4¬∫ ESO</h1>
                                <p class="text-indigo-100 text-lg">1¬™ Evaluaci√≥n - Versi√≥n B</p>
                                <p class="text-indigo-200 text-sm mt-1">üë§ ${state.nombreAlumno}</p>
                            </div>
                        </div>
                        <div class="flex gap-2 flex-wrap">
                            ${state.seccionActual ? '<button onclick="volverInicio()" class="bg-white text-indigo-600 px-4 py-2 rounded-xl hover:bg-indigo-50 transition shadow-lg font-medium">üè† Inicio</button>' : ''}
                            <button onclick="toggleSoluciones()" class="bg-yellow-400 text-gray-800 px-4 py-2 rounded-xl hover:bg-yellow-300 transition shadow-lg font-medium">
                                ${state.mostrarSoluciones ? 'üëÅÔ∏è Ocultar' : '‚úÖ Ver'} Soluciones
                            </button>
                            <button onclick="imprimirExamen()" class="bg-green-500 text-white px-4 py-2 rounded-xl hover:bg-green-600 transition shadow-lg font-medium">
                                üñ®Ô∏è Imprimir
                            </button>
                            <button onclick="reiniciarProgreso()" class="bg-red-500 text-white px-4 py-2 rounded-xl hover:bg-red-600 transition shadow-lg font-medium">
                                üîÑ Reiniciar
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderMenuPrincipal() {
            return `
                <div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2">
                        <span class="text-3xl">üìã</span> Selecciona una Secci√≥n
                    </h2>
                    <div class="grid md:grid-cols-3 gap-6">
                        ${Object.entries(ejercicios).map(([key, seccion]) => `
                            <div onclick="verSeccion('${key}')" 
                                class="bg-gradient-to-br ${seccion.color} rounded-2xl shadow-xl p-8 cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-2xl text-white">
                                <h3 class="font-bold text-2xl mb-4">${seccion.title}</h3>
                                <p class="text-white text-opacity-90 mb-4">${seccion.preguntas.length} preguntas</p>
                                <div class="flex items-center text-white font-medium">
                                    Comenzar ‚Üí
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderSeccion() {
            const seccion = ejercicios[state.seccionActual];
            return `
                <div>
                    <div class="bg-gradient-to-r ${seccion.color} rounded-2xl shadow-xl p-8 mb-8 text-white">
                        <h2 class="text-3xl font-bold">${seccion.title}</h2>
                        <p class="text-white text-opacity-90 mt-2">${seccion.preguntas.length} preguntas</p>
                    </div>
                    
                    <div class="space-y-6">
                        ${seccion.preguntas.map(pregunta => renderPregunta(pregunta)).join('')}
                    </div>
                </div>
            `;
        }

        function renderPregunta(pregunta) {
            return `
                <div class="bg-white rounded-xl shadow-lg p-6 border-2 border-gray-200">
                    <div class="flex items-start gap-4">
                        <span class="bg-indigo-100 text-indigo-800 px-4 py-2 rounded-full text-sm font-bold min-w-fit">
                            #${pregunta.num}
                        </span>
                        <div class="flex-1">
                            <div class="text-lg font-semibold text-gray-800 mb-3">
                                ${pregunta.enunciado}
                            </div>
                            
                            ${pregunta.detalle ? `<p class="text-gray-600 mb-3">${pregunta.detalle}</p>` : ''}
                            
                            ${pregunta.formula ? `<div class="math-display bg-gray-50 p-4 rounded-lg mb-4">$$${pregunta.formula}$$</div>` : ''}
                            
                            ${pregunta.partes ? `
                                <div class="space-y-2 mb-4">
                                    ${pregunta.partes.map(parte => `<div class="text-gray-700">${parte}</div>`).join('')}
                                </div>
                            ` : ''}
                            
                            <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-4 mb-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">üìù Tu respuesta:</label>
                                <textarea 
                                    class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none"
                                    rows="3"
                                    placeholder="Escribe aqu√≠ tu respuesta..."
                                ></textarea>
                            </div>
                            
                            ${state.mostrarSoluciones ? `
                                <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4">
                                    <div class="flex items-center gap-2 mb-2">
                                        <span class="text-2xl">‚úÖ</span>
                                        <span class="font-bold text-green-800 text-lg">Soluci√≥n:</span>
                                    </div>
                                    <div class="text-gray-700 math-display">
                                        $$${pregunta.solucion}$$
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', render);
    </script>
</body>
</html>
