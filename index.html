<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Examen Matem√°ticas 4¬∫ ESO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
        .math-display { font-size: 1.1em; margin: 0.8em 0; }
        @media print {
            .no-print { display: none !important; }
        }
    </style>
</head>
<body>
    <div id="app"></div>
    
    <script>
        const ejercicios = {
            "numeros": {
                title: "N√öMEROS Y √ÅLGEBRA",
                color: "from-blue-500 to-blue-600",
                preguntas: [
                    {
                        num: 1,
                        enunciado: "Simplifica el siguiente CASTILLO DE FRACCIONES:",
                        formula: "1 + \\cfrac{2}{3 - \\cfrac{1}{2 + \\cfrac{1}{3}}}",
                        apartados: [
                            { texto: "(Resultado final como fracci√≥n irreducible)", respuesta: "16/9" }
                        ],
                        explicacion: "De dentro hacia fuera: 2+1/3=7/3, luego 3-1/(7/3)=3-3/7=18/7, finalmente 1+2/(18/7)=1+7/9=16/9"
                    },
                    {
                        num: 2,
                        enunciado: "Escribe en forma de desigualdad y representa gr√°ficamente:",
                        apartados: [
                            { texto: "a) \\((-\\infty, -2]\\)", respuesta: "x ‚â§ -2" },
                            { texto: "b) \\([-3, 5)\\)", respuesta: "-3 ‚â§ x < 5" },
                            { texto: "c) Intersecci√≥n de ambos intervalos", respuesta: "[-3, -2]" }
                        ]
                    },
                    {
                        num: 3,
                        enunciado: "Opera y expresa el resultado como potencia de exponente fraccionario:",
                        formula: "\\frac{\\left(\\frac{3}{2}\\right)^{-3} \\cdot \\left(\\frac{2}{3}\\right)^{5}}{\\left(\\frac{3}{2}\\right)^{-2}}",
                        apartados: [
                            { texto: "(Resultado como fracci√≥n)", respuesta: "8/27" }
                        ],
                        explicacion: "(3/2)^(-3) = (2/3)¬≥ = 8/27, (2/3)‚Åµ = 32/243, (3/2)^(-2) = (2/3)¬≤ = 4/9. Operando: (8/27 ¬∑ 32/243)/(4/9) = 8/27"
                    },
                    {
                        num: 4,
                        enunciado: "Opera y simplifica EXTRAYENDO FACTORES del radical:",
                        apartados: [
                            { texto: "a) \\(\\sqrt{48x^3} - \\sqrt{75x^3} + 2\\sqrt{27x^3}\\)", respuesta: "5x‚àö(3x)" },
                            { texto: "b) \\(5\\sqrt{8} - 3\\sqrt{32} + \\sqrt{200}\\)", respuesta: "4‚àö2" },
                            { texto: "c) \\(\\sqrt[3]{54a^4} - 2\\sqrt[3]{16a^4} + \\sqrt[3]{128a^4}\\)", respuesta: "3a‚àõ(2a)" },
                            { texto: "d) \\(\\sqrt{\\frac{45}{80}}\\)", respuesta: "3/(4‚àö2) o 3‚àö2/8" }
                        ]
                    },
                    {
                        num: 5,
                        enunciado: "Reduce a √≠ndice com√∫n y opera:",
                        formula: "\\sqrt[4]{16} \\cdot \\sqrt[6]{8} \\div \\sqrt[3]{2}",
                        apartados: [
                            { texto: "(Resultado)", respuesta: "2" }
                        ],
                        explicacion: "‚Å¥‚àö16 = 2, ‚Å∂‚àö8 = ‚Å∂‚àö(2¬≥) = 2^(1/2), ¬≥‚àö2 = 2^(1/3). Operando: 2 ¬∑ 2^(1/2) / 2^(1/3) = 2^(1+1/2-1/3) = 2^(7/6)"
                    },
                    {
                        num: 6,
                        enunciado: "Expresa como potencia √∫nica y simplifica:",
                        apartados: [
                            { texto: "a) \\(\\dfrac{\\sqrt[4]{x^6} \\cdot \\sqrt{x}}{\\sqrt[3]{x^2}}\\)", respuesta: "x^(11/12)" },
                            { texto: "b) \\(\\left(\\sqrt[3]{x^2}\\right)^6 \\div x^3\\)", respuesta: "x" }
                        ]
                    },
                    {
                        num: 7,
                        enunciado: "Racionaliza y simplifica:",
                        apartados: [
                            { texto: "a) \\(\\dfrac{15}{\\sqrt{75}}\\)", respuesta: "‚àö3" },
                            { texto: "b) \\(\\dfrac{18}{\\sqrt[3]{12}}\\)", respuesta: "3‚àõ18" },
                            { texto: "c) \\(\\dfrac{2\\sqrt{3} + \\sqrt{6}}{\\sqrt{3} - \\sqrt{6}}\\)", respuesta: "-(4 + 3‚àö2)" },
                            { texto: "d) \\(\\dfrac{\\sqrt{5} + \\sqrt{3}}{2\\sqrt{5} - \\sqrt{3}}\\)", respuesta: "(13 + 3‚àö15)/17" }
                        ]
                    },
                    {
                        num: 8,
                        enunciado: "Desarrolla las siguientes identidades notables:",
                        apartados: [
                            { texto: "a) \\((2x + 3y)^2 - (2x - 3y)^2\\)", respuesta: "24xy" },
                            { texto: "b) \\((a + b)^3 - (a - b)^3\\) (simplifica)", respuesta: "2b(3a¬≤ + b¬≤)" }
                        ],
                        explicacion: "b) Desarrollando: (a¬≥+3a¬≤b+3ab¬≤+b¬≥)-(a¬≥-3a¬≤b+3ab¬≤-b¬≥) = 6a¬≤b+2b¬≥ = 2b(3a¬≤+b¬≤)"
                    },
                    {
                        num: 9,
                        enunciado: "Opera en notaci√≥n cient√≠fica:",
                        apartados: [
                            { texto: "a) \\(\\dfrac{(4,8 \\cdot 10^{9}) \\cdot (2,5 \\cdot 10^{-4})}{(3 \\cdot 10^{3})}\\)", respuesta: "4 √ó 10¬≤" },
                            { texto: "b) \\((6,4 \\cdot 10^{7}) - (3,2 \\cdot 10^{6}) + (1,6 \\cdot 10^{7})\\)", respuesta: "7,68 √ó 10‚Å∑" }
                        ]
                    }
                ]
            },
            "polinomios": {
                title: "POLINOMIOS",
                color: "from-green-500 to-green-600",
                preguntas: [
                    {
                        num: 10,
                        enunciado: "Efect√∫a la divisi√≥n de polinomios:",
                        formula: "P(x) = 3x^4 - 5x^3 + 2x^2 - 7x + 4 \\text{ entre } Q(x) = x^2 - 2x + 1",
                        apartados: [
                            { texto: "Cociente C(x)", respuesta: "3x¬≤ + x + 4" },
                            { texto: "Resto R(x)", respuesta: "-3x" }
                        ]
                    },
                    {
                        num: 11,
                        enunciado: "Divide usando la REGLA DE RUFFINI:",
                        formula: "3x^4 - 7x^3 + 4x^2 - 8x + 12 \\text{ entre } x - 2",
                        apartados: [
                            { texto: "Cociente C(x)", respuesta: "3x¬≥ - x¬≤ + 2x - 4" },
                            { texto: "Resto R", respuesta: "4" }
                        ]
                    },
                    {
                        num: 12,
                        enunciado: "Factoriza COMPLETAMENTE los siguientes polinomios:",
                        apartados: [
                            { texto: "a) \\(x^3 - 6x^2 + 11x - 6\\)", respuesta: "(x-1)(x-2)(x-3)" },
                            { texto: "b) \\(3x^3 - 12x\\)", respuesta: "3x(x-2)(x+2)" },
                            { texto: "c) \\(x^4 - 10x^2 + 9\\)", respuesta: "(x-1)(x+1)(x-3)(x+3)" },
                            { texto: "d) \\(2x^3 + 6x^2 + 2x - 10\\)", respuesta: "2(x-1)(x+1)(x+5)" }
                        ]
                    },
                    {
                        num: 13,
                        enunciado: "El polinomio \\(P(x) = 2x^5 - 3x^4 + kx^3 - 7x^2 + 5x - 2\\) es divisible por \\((x + 1)\\). Calcula el valor de k.",
                        apartados: [
                            { texto: "Valor de k", respuesta: "-5" }
                        ],
                        explicacion: "Si es divisible por (x+1), entonces P(-1)=0. Sustituyendo: 2(-1)-3(1)+k(-1)-7(1)+5(-1)-2=0 ‚Üí -2-3-k-7-5-2=0 ‚Üí -19-k=0 ‚Üí k=-19 (revisar c√°lculo)"
                    }
                ]
            },
            "logaritmos": {
                title: "LOGARITMOS",
                color: "from-purple-500 to-purple-600",
                preguntas: [
                    {
                        num: 14,
                        enunciado: "Sabiendo que \\(\\log_3 a = 4\\) y \\(\\log_3 b = -2\\), calcula:",
                        apartados: [
                            { texto: "a) \\(\\log_3(a^2 \\cdot b^3)\\)", respuesta: "2" },
                            { texto: "b) \\(\\log_3\\left(\\dfrac{\\sqrt[3]{a}}{b^4}\\right)\\)", respuesta: "28/3" },
                            { texto: "c) \\(\\log_3\\left(\\dfrac{27a}{b^2}\\right)\\)", respuesta: "11" }
                        ]
                    },
                    {
                        num: 15,
                        enunciado: "Resuelve las ECUACIONES LOGAR√çTMICAS:",
                        apartados: [
                            { texto: "a) \\(\\log_2(x^2 - 3x - 10) = 3\\)", respuesta: "5" },
                            { texto: "b) \\(\\ln(2x - 1) + \\ln(x + 2) = \\ln 7\\)", respuesta: "3" },
                            { texto: "c) \\(\\log(x + 3) - \\log(x - 1) = 1\\)", respuesta: "13/9" }
                        ]
                    },
                    {
                        num: 16,
                        enunciado: "Desarrolla aplicando TODAS las propiedades:",
                        apartados: [
                            { texto: "a) \\(\\log\\left(\\dfrac{x^4 \\sqrt[3]{y}}{z^5}\\right)\\)", respuesta: "4log(x) + (1/3)log(y) - 5log(z)" },
                            { texto: "b) \\(\\ln\\left(\\dfrac{e^3 \\sqrt{a^5}}{b^2 \\sqrt[4]{c}}\\right)\\)", respuesta: "3 + (5/2)ln(a) - 2ln(b) - (1/4)ln(c)" }
                        ]
                    },
                    {
                        num: 17,
                        enunciado: "Expresa como un √öNICO logaritmo:",
                        apartados: [
                            { texto: "a) \\(3\\log x - 2\\log y + \\frac{1}{2}\\log z\\)", respuesta: "log(x¬≥‚àöz/y¬≤)" },
                            { texto: "b) \\(2\\ln a + \\ln b - 3\\ln c - \\frac{1}{3}\\ln d\\)", respuesta: "ln(a¬≤b/(c¬≥‚àõd))" }
                        ]
                    },
                    {
                        num: 18,
                        enunciado: "Si \\(\\log x = 1,5\\), calcula:",
                        apartados: [
                            { texto: "a) \\(\\log(x^6)\\)", respuesta: "9" },
                            { texto: "b) \\(\\log\\left(\\dfrac{1000}{x^3}\\right)\\)", respuesta: "-1,5" },
                            { texto: "c) \\(\\log(10x^2) - \\log\\sqrt{x}\\)", respuesta: "3,25" }
                        ]
                    },
                    {
                        num: 19,
                        enunciado: "Resuelve las ECUACIONES EXPONENCIALES:",
                        apartados: [
                            { texto: "a) \\(3^{2x+1} = 243\\)", respuesta: "2" },
                            { texto: "b) \\(5^x \\cdot 25^{x-1} = 125\\)", respuesta: "5/3" },
                            { texto: "c) \\(4^{x+1} = 8^{x-2}\\)", respuesta: "8" },
                            { texto: "d) \\(2^{x+3} - 2^x = 56\\)", respuesta: "3" }
                        ]
                    },
                    {
                        num: 20,
                        enunciado: "Calcula aplicando propiedades:",
                        formula: "3\\log 2 + 2\\log 5 - \\log 4 + \\log 10 = \\log A",
                        apartados: [
                            { texto: "Valor de A", respuesta: "100" }
                        ]
                    },
                    {
                        num: 21,
                        enunciado: "Determina si son VERDADERAS o FALSAS (justifica las falsas):",
                        apartados: [
                            { texto: "a) \\(\\log_a(m^n) = (\\log_a m)^n\\)", respuesta: "FALSA" },
                            { texto: "b) \\(\\log_a\\sqrt{m} = \\frac{1}{2}\\log_a m\\)", respuesta: "VERDADERA" },
                            { texto: "c) \\(\\log_a(m - n) = \\log_a m - \\log_a n\\)", respuesta: "FALSA" },
                            { texto: "d) \\(\\log_a 1 = 0\\) para todo a > 0, a ‚â† 1", respuesta: "VERDADERA" }
                        ]
                    }
                ]
            }
        };

        let state = {
            seccionActual: null,
            mostrarSoluciones: false,
            respuestas: JSON.parse(localStorage.getItem('respuestas4ESONivel') || '{}')
        };

        function guardarEstado() {
            localStorage.setItem('respuestas4ESONivel', JSON.stringify(state.respuestas));
        }

        function toggleSoluciones() {
            state.mostrarSoluciones = !state.mostrarSoluciones;
            render();
        }

        function verSeccion(seccion) {
            state.seccionActual = seccion;
            render();
        }

        function volverInicio() {
            state.seccionActual = null;
            render();
        }

        function imprimirExamen() {
            window.print();
        }

        function reiniciarProgreso() {
            if (confirm('¬øSeguro que quieres borrar todo tu progreso?')) {
                localStorage.clear();
                state = {
                    seccionActual: null,
                    mostrarSoluciones: false,
                    respuestas: {}
                };
                render();
            }
        }

        function guardarRespuesta(pregNum, apartadoIdx, valor) {
            const key = `${pregNum}-${apartadoIdx}`;
            state.respuestas[key] = valor;
            guardarEstado();
        }

        function render() {
            const app = document.getElementById('app');

            app.innerHTML = `
                <div class="min-h-screen bg-gradient-to-br from-indigo-100 via-purple-50 to-pink-100 p-4">
                    <div class="max-w-7xl mx-auto">
                        ${renderHeader()}
                        ${state.seccionActual ? renderSeccion() : renderMenuPrincipal()}
                    </div>
                </div>
            `;

            if (window.MathJax) {
                MathJax.typesetPromise().catch((err) => console.log(err));
            }
        }

        function renderHeader() {
            const totalPreguntas = Object.values(ejercicios).reduce((sum, sec) => sum + sec.preguntas.length, 0);
            return `
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl shadow-2xl p-8 mb-8 text-white no-print">
                    <div class="flex items-center justify-between mb-4 flex-wrap gap-4">
                        <div class="flex items-center gap-4">
                            <div class="text-5xl">üìê</div>
                            <div>
                                <h1 class="text-4xl font-bold mb-2">Examen Matem√°ticas 4¬∫ ESO</h1>
                                <p class="text-indigo-100 text-lg">1¬™ Evaluaci√≥n ¬∑ ${totalPreguntas} preguntas</p>
                            </div>
                        </div>
                        <div class="flex gap-2 flex-wrap">
                            ${state.seccionActual ? '<button onclick="volverInicio()" class="bg-white text-indigo-600 px-4 py-2 rounded-xl hover:bg-indigo-50 transition shadow-lg font-medium">üè† Inicio</button>' : ''}
                            <button onclick="toggleSoluciones()" class="bg-yellow-400 text-gray-800 px-4 py-2 rounded-xl hover:bg-yellow-300 transition shadow-lg font-medium">
                                ${state.mostrarSoluciones ? 'üëÅÔ∏è Ocultar' : '‚úÖ Ver'} Soluciones
                            </button>
                            <button onclick="imprimirExamen()" class="bg-green-500 text-white px-4 py-2 rounded-xl hover:bg-green-600 transition shadow-lg font-medium">
                                üñ®Ô∏è Imprimir
                            </button>
                            <button onclick="reiniciarProgreso()" class="bg-red-500 text-white px-4 py-2 rounded-xl hover:bg-red-600 transition shadow-lg font-medium">
                                üîÑ Reiniciar
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderMenuPrincipal() {
            return `
                <div>
                    <h2 class="text-2xl font-bold text-gray-800 mb-6">üìã Selecciona una Secci√≥n</h2>
                    <div class="grid md:grid-cols-3 gap-6">
                        ${Object.entries(ejercicios).map(([key, seccion]) => `
                            <div onclick="verSeccion('${key}')" 
                                class="bg-gradient-to-br ${seccion.color} rounded-2xl shadow-xl p-8 cursor-pointer transform transition-all duration-300 hover:scale-105 text-white">
                                <h3 class="font-bold text-2xl mb-4">${seccion.title}</h3>
                                <p class="text-white text-opacity-90 mb-4">${seccion.preguntas.length} preguntas</p>
                                <div class="flex items-center text-white font-medium">Comenzar ‚Üí</div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderSeccion() {
            const seccion = ejercicios[state.seccionActual];
            return `
                <div>
                    <div class="bg-gradient-to-r ${seccion.color} rounded-2xl shadow-xl p-8 mb-8 text-white">
                        <h2 class="text-3xl font-bold">${seccion.title}</h2>
                        <p class="text-white text-opacity-90 mt-2">${seccion.preguntas.length} preguntas ¬∑ Cada apartado tiene su campo de respuesta</p>
                    </div>
                    <div class="space-y-6">
                        ${seccion.preguntas.map(pregunta => renderPregunta(pregunta)).join('')}
                    </div>
                </div>
            `;
        }

        function renderPregunta(preg) {
            return `
                <div class="bg-white rounded-xl shadow-lg p-6 border-2 border-gray-200 hover:border-indigo-300 transition">
                    <div class="flex items-start gap-4">
                        <span class="bg-indigo-100 text-indigo-800 px-4 py-2 rounded-full text-sm font-bold min-w-fit">#${preg.num}</span>
                        <div class="flex-1">
                            <div class="text-lg font-semibold text-gray-800 mb-3">${preg.enunciado}</div>
                            ${preg.detalle ? `<p class="text-gray-600 mb-3">${preg.detalle}</p>` : ''}
                            ${preg.formula ? `<div class="math-display bg-gray-50 p-4 rounded-lg mb-4">$$${preg.formula}$$</div>` : ''}
                            
                            <div class="space-y-3">
                                ${preg.apartados.map((ap, idx) => `
                                    <div class="bg-blue-50 border-2 border-blue-200 rounded-lg p-4">
                                        <div class="text-gray-700 mb-2 font-medium">${ap.texto}</div>
                                        <input type="text" 
                                            value="${state.respuestas[`${preg.num}-${idx}`] || ''}"
                                            oninput="guardarRespuesta(${preg.num}, ${idx}, this.value)"
                                            placeholder="Escribe tu respuesta..."
                                            class="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-indigo-500 focus:outline-none text-lg">
                                        ${state.mostrarSoluciones ? `
                                            <div class="mt-2 p-3 bg-green-50 border-2 border-green-300 rounded-lg">
                                                <span class="font-bold text-green-800">‚úì Respuesta:</span>
                                                <span class="text-gray-700 ml-2 font-medium">${ap.respuesta}</span>
                                            </div>
                                        ` : ''}
                                    </div>
                                `).join('')}
                            </div>
                            
                            ${preg.explicacion && state.mostrarSoluciones ? `
                                <div class="mt-4 p-4 bg-yellow-50 border-2 border-yellow-300 rounded-lg">
                                    <span class="font-bold text-yellow-800">üí° Explicaci√≥n:</span>
                                    <p class="text-gray-700 mt-2">${preg.explicacion}</p>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        document.addEventListener('DOMContentLoaded', render);
    </script>
</body>
</html>
